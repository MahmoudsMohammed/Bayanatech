<div class="purchase-invoice">
  <app-navigator [title]="title"></app-navigator>

  <div class="filters">
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col-lg-3 col-md-6 mb-0 mb-md-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "account name" | translate }}</label
            >
            <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              ngModel
              name="user"
            >
              <ng-option *ngFor="let user of users" [value]="user.id">{{
                user.Name
              }}</ng-option>
            </ng-select>
          </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-0 mb-md-3">
          <div class="form-group timeInput">
            <label class="col-form-label">{{ "Chose Date" | translate }}</label>
            <input
              placeholder="{{ 'Chose Date' | translate }}"
              name="date"
              ngModel
              type="text"
              class="form-control"
              invoice
              status
              bsDaterangepicker
              #dpr="bsDaterangepicker"
            />
          </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-0 mb-md-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "invoice status" | translate }}</label
            >
            <ng-select>
              <ng-option>الكل </ng-option>
              <ng-option>ملغي</ng-option>
              <ng-option>ساري</ng-option>
            </ng-select>
          </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-0 mb-md-3">
          <label for="search" class="col-form-label"
            >{{ "search" | translate }}:
          </label>
          <input type="text" class="form-control" id="search" />
        </div>
      </div>
    </div>
  </div>
  <!-- table -->
  <div class="overflow-auto mt-4">
    <table
      mat-table
      [dataSource]="projectsDataSource"
      matSort
      class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
    >
      <ng-container matColumnDef="returnNumber">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "return number" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.returnNumber }}
        </td>
      </ng-container>
      <ng-container matColumnDef="itsHistory">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "its history" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.itsHistory }}
        </td>
      </ng-container>
      <ng-container matColumnDef="invoiceNumber">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "invoice number" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.invoiceNumber }}
        </td>
      </ng-container>
      <ng-container matColumnDef="PaymentType">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Payment type" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.PaymentType }}
        </td>
      </ng-container>
      <ng-container matColumnDef="RegistrationNumber">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Registration number" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.RegistrationNumber }}
        </td>
      </ng-container>
      <ng-container matColumnDef="Statement">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Statement" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.Statement }}
        </td>
      </ng-container>
      <ng-container matColumnDef="theAmount">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "the amount" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.theAmount }}
        </td>
      </ng-container>

      <ng-container matColumnDef="Tax">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Tax" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.Tax }}
        </td>
      </ng-container>

      <ng-container matColumnDef="Total">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Total" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.Total }}
        </td>
      </ng-container>

      <ng-container matColumnDef="theCondition">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "the condition" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.theCondition }}
        </td>
      </ng-container>

      <ng-container matColumnDef="operations">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "operations" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
              <div class="child-btns">
                <span class="dtr-data">
                  <!-- عرض القيد العكسي  -->
                  <button
                    type="button"
                    id="68"
                    class="EditProjectPhasesTasks btn btn-outline-warning btn-sm waves-effect mx-1"
                    data-toggle="tooltip"
                    data-placement="top"
                    title=" عرض القيد العكسي"
                    data-original-title=" عرض القيد العكسي"
                    (click)="open(runningTasksModal)"
                  >
                    <i class="fa-brands fa-stripe-s"></i>
                  </button>


                  <!--طباعة  -->
                  <button
                    type="button"
                    id="68"
                    class="AddNewTaskbtn btn btn-outline-success btn-sm waves-effect mx-1"
                    data-toggle="tooltip"
                    data-placement="top"
                    title=" طباعة "
                    data-original-title="طباعة "
                  >
                    <i class="fa-solid fa-print"></i>
                  </button>
                </span>
              </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="projectDisplayedColumns"></tr>

      <tr
        mat-row
        *matRowDef="let row; columns: projectDisplayedColumns"
        class=" "
      ></tr>
    </table>
  </div>
  <mat-paginator [pageSizeOptions]="[10, 25]"> </mat-paginator>
</div>

<!-- runningTasksModal -->
<ng-template #runningTasksModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "Show_reverse_entry" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="max-h-100 overflow-x-scroll overflow-y-scroll p-4">
    <table class="table-fixed border border-gray-500">
      <thead>
        <tr>
          <th class="w-1/9 px-4 py-2">{{ "date" | translate }}</th>
          <th class="w-1/9 px-4 py-2">{{ "Bond number" | translate }}</th>
          <th class="w-1/9 px-4 py-2">{{ "Bond type" | translate }}</th>
          <th class="w-1/9 px-4 py-2">
            {{ "Registration number" | translate }}
          </th>
          <th class="w-1/9 px-4 py-2">{{ "account code" | translate }}</th>
          <th class="w-1/9 px-4 py-2">{{ "account name" | translate }}</th>
          <th class="w-1/9 px-4 py-2">{{ "Statement" | translate }}</th>
          <th class="w-1/9 px-4 py-2">{{ "debtor" | translate }}</th>
          <th class="w-1/9 px-4 py-2">{{ "Creditor" | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entry of accountingEntries">
          <td class="w-1/9 border px-4 py-2">{{ entry.date }}</td>
          <td class="w-1/9 border px-4 py-2">{{ entry.bondNumber }}</td>
          <td class="w-1/9 border px-4 py-2">{{ entry.bondType }}</td>
          <td class="w-1/9 border px-4 py-2">{{ entry.registrationNumber }}</td>
          <td class="w-1/9 border px-4 py-2">{{ entry.accountCode }}</td>
          <td class="w-1/9 border px-4 py-2">{{ entry.accountName }}</td>
          <td class="w-1/9 border px-4 py-2">{{ entry.statement }}</td>
          <td class="w-1/9 border px-4 py-2">{{ entry.debtor }}</td>
          <td class="w-1/9 border px-4 py-2">{{ entry.creditor }}</td>
        </tr>
        <tr>
          <td class="w-1/9 border px-4 py-2">{{ "total" | translate }}</td>
          <td class="w-1/9 border px-4 py-2"></td>
          <td class="w-1/9 border px-4 py-2"></td>
          <td class="w-1/9 border px-4 py-2"></td>
          <td class="w-1/9 border px-4 py-2"></td>
          <td class="w-1/9 border px-4 py-2"></td>
          <td class="w-1/9 border px-4 py-2"></td>
          <td class="w-1/9 border px-4 py-2 bg-green-500">{{ totalDebtor }}</td>
          <td class="w-1/9 border px-4 py-2 bg-red-500">{{ totalCreditor }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="flex justify-end p-3">
    <button
      class="btn text-white me-2"
      style="background-color: var(--base-color)"
    >
      {{ "Print" | translate }}
    </button>

    <button (click)="modal?.dismiss()" class="btn btn-secondary">
      {{ "close" | translate }}
    </button>
  </div>
</ng-template>

