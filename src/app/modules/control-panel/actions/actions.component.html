<div class="system-actions">
  <app-navigator [title]="title"></app-navigator>

  <div class="filters mb-4 flex align-items-end gap-4 flex-wrap">
    <div class="form-group">
      <label class="text-right col-form-label block">
        {{ "search" | translate }}</label
      >
      <input
        (keyup)="applyFilter($event)"
        class="form-control"
        style="max-width: 300px"
        #input
        placeholder="{{ 'search' | translate }}"
      />
    </div>
    <div class="form-group">
      <label class="text-right col-form-label block">
        {{ "userName" | translate }}</label
      >
      <ng-select
        class="w-full p-0"
        placeholder="{{ 'Chose' | translate }}"
        ngModel
        name="user"
      >
        <ng-option *ngFor="let user of users" [value]="user.id">{{
          user.Name
        }}</ng-option>
      </ng-select>
    </div>
    <div class="form-group flex items-center gap-1">
      <input type="checkbox" name="date" id="date" [(ngModel)]="dateFilter" />
      <label for="date" class="mx-2 mb-0">{{ "Date" | translate }}</label>
    </div>
    <div class="form-group timeInput">
      <label class="text-right col-form-label block">{{
        "Chose Date" | translate
      }}</label>
      <input
        placeholder="{{ 'Chose Date' | translate }}"
        name="date"
        ngModel
        type="text"
        class="form-control"
        bsDaterangepicker
        #dpr="bsDaterangepicker"
        [disabled]="!dateFilter"
      />
    </div>
    <div class="form-group">
      <label class="text-right col-form-label block">
        {{ "movement type" | translate }}</label
      >
      <ng-select
        class="w-full p-0"
        placeholder="{{ 'Chose' | translate }}"
        ngModel
        name="movementType"
      >
        <ng-option
          *ngFor="let item of movementTypes"
          [value]="item.en"
          [translate]="'name'"
          [translateParams]="{ ar: item.ar, en: item.en }"
        ></ng-option>
      </ng-select>
    </div>
  </div>

  <div class="tables-data mt-3 overflow-hidden">
    <!-- table -->

    <div class="overflow-auto">
      <table
        mat-table
        [dataSource]="dataSource"
        matSort
        class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
      >
        <!-- Movement history column -->
        <ng-container matColumnDef="movementHistory">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "Movement history" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span [dir]="'dir' | translate">{{
              element?.movementHistory | date : "a h:m:s , dd-MM-yyyy"
            }}</span>
          </td>
        </ng-container>
        <!-- process status column -->
        <ng-container matColumnDef="processStatus">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "process status" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element?.processStatus }}</span>
          </td>
        </ng-container>
        <!-- user name column -->
        <ng-container matColumnDef="userName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "user name" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element?.userName }}</span>
          </td>
        </ng-container>
        <!-- branch column -->
        <ng-container matColumnDef="branch">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "branch" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element?.branch }}</span>
          </td>
        </ng-container>
        <!-- comments column -->
        <ng-container matColumnDef="comments">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "comments" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element?.comments }}</span>
          </td>
        </ng-container>
        <!-- the message column -->
        <ng-container matColumnDef="message">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "the message" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element?.message }}</span>
          </td>
        </ng-container>
        <!-- Function name column -->
        <ng-container matColumnDef="functionName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "Function name" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element?.functionName }}</span>
          </td>
        </ng-container>
        <!-- Service name column -->
        <ng-container matColumnDef="serviceName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "Service name" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element?.serviceName }}</span>
          </td>
        </ng-container>
        <!-- Operation success column -->
        <ng-container matColumnDef="OperationSuccess">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "Operation success" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span
              class="{{
                element?.OperationSuccess ? 'text-green-500' : 'text-red-500'
              }} fw-bold"
              >{{
                element?.OperationSuccess
                  ? ("successful operation" | translate)
                  : ("failed operation" | translate)
              }}</span
            >
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          class="duration-300 hover:bg-slate-100"
        ></tr>

        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="4">
            {{ "noResult" | translate }} "{{ input.value }}"
          </td>
        </tr>
      </table>
    </div>
    <mat-paginator [pageSizeOptions]="[10, 25]"> </mat-paginator>
  </div>
</div>
